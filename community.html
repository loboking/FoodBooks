<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoodBooks Community - ë ˆì‹œí”¼ ê³µìœ  ê²Œì‹œíŒ</title>
    <link rel="stylesheet" href="css/community.css">
</head>
<body>
    <div id="app">
        <!-- í—¤ë” -->
        <header class="header">
            <div class="header-content">
                <a href="index.html" class="back-link">â† FoodBooks</a>
                <h1 class="logo">Community</h1>
                <button class="write-btn" onclick="Community.openWriteModal()">+ ê¸€ì“°ê¸°</button>
            </div>
        </header>

        <!-- ê²€ìƒ‰/í•„í„° -->
        <section class="search-section">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="ë ˆì‹œí”¼ ê²€ìƒ‰..." oninput="Community.search(this.value)">
            </div>
            <div class="filter-tags">
                <button class="tag active" data-category="all" onclick="Community.filterByCategory('all')">ì „ì²´</button>
                <button class="tag" data-category="korean" onclick="Community.filterByCategory('korean')">í•œì‹</button>
                <button class="tag" data-category="chinese" onclick="Community.filterByCategory('chinese')">ì¤‘ì‹</button>
                <button class="tag" data-category="japanese" onclick="Community.filterByCategory('japanese')">ì¼ì‹</button>
                <button class="tag" data-category="western" onclick="Community.filterByCategory('western')">ì–‘ì‹</button>
                <button class="tag" data-category="dessert" onclick="Community.filterByCategory('dessert')">ë””ì €íŠ¸</button>
            </div>
        </section>

        <!-- ì •ë ¬ ì˜µì…˜ -->
        <section class="sort-section">
            <span class="post-count">ì´ <strong id="postCount">0</strong>ê°œì˜ ë ˆì‹œí”¼</span>
            <select id="sortSelect" onchange="Community.sort(this.value)">
                <option value="latest">ìµœì‹ ìˆœ</option>
                <option value="popular">ì¸ê¸°ìˆœ</option>
                <option value="views">ì¡°íšŒìˆœ</option>
            </select>
        </section>

        <!-- ê²Œì‹œíŒ ëª©ë¡ -->
        <main class="post-list" id="postList">
            <!-- ë™ì ìœ¼ë¡œ ë¡œë“œ -->
        </main>

        <!-- ë¡œë”© -->
        <div class="loading hidden" id="loading">
            <div class="spinner"></div>
        </div>

        <!-- ë¹ˆ ìƒíƒœ -->
        <div class="empty-state hidden" id="emptyState">
            <div class="empty-icon">ğŸ“</div>
            <p>ì•„ì§ ë“±ë¡ëœ ë ˆì‹œí”¼ê°€ ì—†ìŠµë‹ˆë‹¤</p>
            <button class="btn-primary" onclick="Community.openWriteModal()">ì²« ë ˆì‹œí”¼ ë“±ë¡í•˜ê¸°</button>
        </div>
    </div>

    <!-- ê¸€ì“°ê¸° ëª¨ë‹¬ -->
    <div class="modal-overlay hidden" id="writeModal">
        <div class="modal">
            <div class="modal-header">
                <h2>ë ˆì‹œí”¼ ë“±ë¡</h2>
                <button class="close-btn" onclick="Community.closeWriteModal()">Ã—</button>
            </div>
            <form class="modal-body" id="recipeForm" onsubmit="Community.submitRecipe(event)">
                <div class="form-group">
                    <label>ë ˆì‹œí”¼ ì œëª© *</label>
                    <input type="text" id="recipeTitle" required placeholder="ì˜ˆ: ì—„ë§ˆí‘œ ê¹€ì¹˜ì°Œê°œ">
                </div>

                <div class="form-group">
                    <label>ì¹´í…Œê³ ë¦¬ *</label>
                    <select id="recipeCategory" required>
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="korean">í•œì‹</option>
                        <option value="chinese">ì¤‘ì‹</option>
                        <option value="japanese">ì¼ì‹</option>
                        <option value="western">ì–‘ì‹</option>
                        <option value="dessert">ë””ì €íŠ¸</option>
                        <option value="other">ê¸°íƒ€</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ëŒ€í‘œ ì´ë¯¸ì§€ URL</label>
                    <input type="url" id="recipeImage" placeholder="https://...">
                    <small>Unsplash ë“±ì—ì„œ ì´ë¯¸ì§€ URLì„ ë³µì‚¬í•´ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”</small>
                </div>

                <div class="form-group">
                    <label>ì†Œê°œ *</label>
                    <textarea id="recipeDescription" required rows="2" placeholder="ë ˆì‹œí”¼ë¥¼ ê°„ë‹¨íˆ ì†Œê°œí•´ì£¼ì„¸ìš”"></textarea>
                </div>

                <div class="form-group">
                    <label>ì¬ë£Œ *</label>
                    <textarea id="recipeIngredients" required rows="4" placeholder="- ë¼ì§€ê³ ê¸° 300g&#10;- ê¹€ì¹˜ 200g&#10;- ë‘ë¶€ 1ëª¨"></textarea>
                </div>

                <div class="form-group">
                    <label>ì¡°ë¦¬ ë°©ë²• *</label>
                    <textarea id="recipeSteps" required rows="6" placeholder="1. ë¼ì§€ê³ ê¸°ë¥¼ ë¨¼ì € ë³¶ì•„ì£¼ì„¸ìš”&#10;2. ê¹€ì¹˜ë¥¼ ë„£ê³  í•¨ê»˜ ë³¶ìŠµë‹ˆë‹¤&#10;3. ë¬¼ì„ ë¶“ê³  ë“ì—¬ì£¼ì„¸ìš”"></textarea>
                </div>

                <div class="form-group">
                    <label>ì‘ì„±ì</label>
                    <input type="text" id="authorName" placeholder="ë‹‰ë„¤ì„ (ì„ íƒ)">
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="Community.closeWriteModal()">ì·¨ì†Œ</button>
                    <button type="submit" class="btn-primary">ë“±ë¡í•˜ê¸°</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
    <div class="modal-overlay hidden" id="detailModal">
        <div class="modal modal-large">
            <div class="modal-header">
                <h2 id="detailTitle">ë ˆì‹œí”¼ ì œëª©</h2>
                <button class="close-btn" onclick="Community.closeDetailModal()">Ã—</button>
            </div>
            <div class="modal-body" id="detailContent">
                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œ -->
            </div>
        </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, updateDoc, doc, deleteDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAUg3760QqRY2uQbcgJ7ClJ_0N4YnK6Z94",
            authDomain: "foodbooks-community.firebaseapp.com",
            projectId: "foodbooks-community",
            storageBucket: "foodbooks-community.firebasestorage.app",
            messagingSenderId: "869188183762",
            appId: "1:869188183762:web:40b295cbc68777338f6f0b",
            measurementId: "G-PKDQEFT0LV"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Firebaseë¥¼ ì „ì—­ìœ¼ë¡œ ì‚¬ìš©
        window.firebaseDB = db;
        window.firebaseCollection = collection;
        window.firebaseAddDoc = addDoc;
        window.firebaseGetDocs = getDocs;
        window.firebaseUpdateDoc = updateDoc;
        window.firebaseDoc = doc;
        window.firebaseDeleteDoc = deleteDoc;
        window.firebaseQuery = query;
        window.firebaseOrderBy = orderBy;
        window.firebaseOnSnapshot = onSnapshot;

        // Firebase ì¤€ë¹„ ì™„ë£Œ í›„ Community ì´ˆê¸°í™”
        window.firebaseReady = true;
        if (window.Community) {
            Community.init();
        }
    </script>
    <script src="js/community.js"></script>
</body>
</html>
